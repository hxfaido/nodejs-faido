
var CONST = require("../utils/const").LOG;

//console color -> http://en.wikipedia.org/wiki/ANSI_escape_code#graphics
//since the console bg is black often, so we not use the black[30,39] , gray[90,39]  as fg color.

var colors = [
    [32,39],        //green
    [33,39],        //yellow
    [34,39],        //blue
    [35,39],        //magenta
    [36,39],        //cyan
    [37,39]         //white
];

var fixed = {};
fixed[CONST.DEFAULT_LOG] = [39,39];        //default
fixed[CONST.ERR_LOG] = [31,39];            //red

function log_console(category) {
   
    this.color = fixed[category];
    
    if (!this.color) {
        
        var total = 0;
        var buf = new Buffer(category);
        for(var i = 0; i < buf.length; i++)
            total += buf[i];
        
        this.color = colors[total % colors.length];
    }
}

log_console.prototype.write = function(timestamp,str){
  
    process.stdout.write("\u001b[" + this.color[0] + "m");      //set color
    process.stdout.write(timestamp);
    process.stdout.write(str);
    process.stdout.write("\u001b[" + this.color[1] + "m");      //restore color
    process.stdout.write("\n");
};

module.exports = log_console;

