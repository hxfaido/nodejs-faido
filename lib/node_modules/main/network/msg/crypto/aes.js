
//aes crypto

var crypto = require("crypto");
var CONST = require("../../../utils/const").NET;

function aes(key){
   
   this.key = key ? key : CONST.AES_KEY;
}

aes.prototype.encode = function(buf){
   
   var cipher = crypto.createCipher("aes128",this.key);
   var buf1 = cipher.update(buf);
   var buf2 = cipher.final();
   
   //merge buf
   data = new Buffer(buf1.length + buf2.length);
   buf1.copy(data);
   buf2.copy(data,buf1.length);
   
   return data;
};

aes.prototype.decode = function(buf){
   
   var decipher = crypto.createDecipher("aes128",this.key);
   var buf1 = decipher.update(buf);
   var buf2 = decipher.final();
   
   //merge buf
   data = new Buffer(buf1.length + buf2.length);
   buf1.copy(data);
   buf2.copy(data,buf1.length);
   
   return data;
};

module.exports = aes;

